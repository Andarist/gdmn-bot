# Первоначальная настройка данных

  Перед установкой бота на клиенте необходимо добавить информацию о нем в файл customers.json,
который расположен на сервере в папке data.

# Экспорт данных из Гедымина

  Для выгрузки данных из базы клиента необходимо установить ПИ "БОТ.Экспорт файлов" ("GS.Общие.Функции работы с json" ?).

  Для работы с сервером необходимо заполнить следующие значения констант в справочнике "Исследователь » Сервис » Константы":
    1. "БОТ. ИД клиента" - это ИД, которое соответствует ИД записи клиента из файла customers.json ("brl", "bmkk");
    2. "БОТ. Адрес сервера" - пока http://localhost:3000.

  ПИ "БОТ.Экспорт файлов" содержит основные функции (Исследователь » Бот):
    1. "Экспорт сотрудников";
    2. "Экспорт видов начислений";
    3. "Экспорт расчетных листов".


  Данные для экспорта сотрудников вытягиваются за период, который будет запрашиваться параметром.

  На данный момент их необходимо запускать вручную после изменения каких-либо данных.
  При приеме на работу\увольнение сотрудника

   добавление\удаление типов начислений\удержаний, расчет итогового начисления)


  Макросы экспорта данных состоят из 2 основных частей:
  1. Выполнение запросов и подготовка данных в JSON формате;
  2. Отправка файлов на сервер.

# Рассылка сообщений пользователям о том, что появился новый расчетный листок

  1. После загрузки нового расчетного листка пробежать по все пользователям из файла

Единица выгрузки из базы данных это один расчетный листок, за один целый календарный месяц, по одному сотруднику.

Подразделение и должность определяется на дату окончания
месяца расчетного листка. И всегда передается вместе
с расчетным листком.

Если человек в один месяц работал в одном подразделении,
в другой -- в другом, то у него в каждом расчетном листке
будет сохранено соответствующее подразделение.

Если человек в течение месяца переводился из подразделения в подразделение или с должности на должность, то в расчетный листок попадет только последнее.



## Формат строки данных расчетного листка
Данные по расчетному листку извлекаются всегда за один целый месяц по одному сотруднику. На основании них формируется ОДНА строка следующего формата:
```
V,EID,Y,DN,X
```
# Пример
Данные передаются одной строкой. Ниже мы можем переносить строку для удобства отображения на экране.
```
1,545624_54675,2020,"автотранспортный парк",2,
```
# Описание полей
```
| ID | Note
|----|------
| V  | Номер версии данных. Всегда значение 1.
| EID| employeeId. RUID контакта из Гедымина.
| DB | Год ??????
| DN | Имя подразделения из бд. Будем считать, что это
|    | имя на русском языке, когда на сервере будем
|    | преобразовывать в структуру LName.
| X  | Количество начислений в расчетном листке.
|    | Сами начисления идут сразу же за полем X.
|    | На каждое начисление передается 4 поля,
|    | описанных ниже.

```